'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import React, { useEffect, useRef, useState } from 'react';

const HeaderComponent = () => {
  const ref = useRef<HTMLUListElement | null>(null);
  const pathname = usePathname();

  // define local state
  const [isDrawerOpen, setIsDrawerOpen] = useState<boolean>(false);

  // This module is for to detect user outside click of the given id
  // It will help us to close our open navigation
  useEffect(() => {
    if (typeof window !== 'undefined') {
      const handleClickOutside = (event: Event) => {
        if (ref.current && !ref.current.contains(event.target as Node)) {
          if (isDrawerOpen) setIsDrawerOpen(false);
        }
      };
      document.addEventListener('click', handleClickOutside, true);
      return () => {
        document.removeEventListener('click', handleClickOutside, true);
      };
    }
  }, [isDrawerOpen]);

  /**
   * description :- This method will trigger/open drawer navigation
   * @created_by :- {Al-Amin}
   * @created_at :- 8/08/2024
   */
  const openDrawerNav = () => setIsDrawerOpen((prv) => !prv);

  /**
   * description :- In mobile view if drawer is already opened, then need to close it
   * @created_by :- {Al-Amin}
   * @created_at :- 8/08/2024
   */
  const onCloseDrawerNav = () => (isDrawerOpen ? setIsDrawerOpen(false) : null);

  return (
    <nav className='pt-[5px] lg:pt-[20px]'>
      {/* for drawer navigation only lg: 1024 screen size */}
      <div className='container relative py-[20px]'>
        <div className='nav-wrapper flex'>
          <Link
            href='/'
            className='m-0 flex items-center p-0 pr-4 text-center text-3xl font-semibold tracking-wider text-theme-secondary sm:text-4xl md:pr-0 dark:text-white'
          >
            <svg
              className='group h-9 w-9 transform transition-transform duration-300 ease-in-out'
              viewBox='0 0 36 36'
              fill='none'
              xmlns='http://www.w3.org/2000/svg'
            >
              <path
                d='M16.7079 20.6236C16.2982 20.6236 15.9052 20.7702 15.6155 21.0312C15.3258 21.2921 15.1631 21.646 15.1631 22.015V22.3392C15.1647 23.5507 15.6997 24.712 16.6507 25.5687C17.6018 26.4253 18.8912 26.9071 20.2361 26.9086H21.2441C22.589 26.9071 23.8784 26.4253 24.8295 25.5687C25.7805 24.712 26.3155 23.5507 26.3171 22.3392V21.2769C26.3155 20.0655 25.7805 18.9041 24.8295 18.0475C23.8784 17.1909 22.589 16.709 21.2441 16.7075H20.2361C19.7104 16.707 19.2064 16.5187 18.8345 16.1839C18.4627 15.8491 18.2534 15.3952 18.2526 14.9216V13.8433C18.2532 13.3696 18.4624 12.9155 18.8343 12.5806C19.2061 12.2457 19.7103 12.0573 20.2361 12.0567H21.2441C21.7699 12.0573 22.2741 12.2457 22.6459 12.5806C23.0178 12.9155 23.227 13.3696 23.2276 13.8433C23.2276 14.2123 23.3903 14.5662 23.68 14.8272C23.9697 15.0881 24.3626 15.2347 24.7723 15.2347C25.182 15.2347 25.575 15.0881 25.8647 14.8272C26.1544 14.5662 26.3171 14.2123 26.3171 13.8433C26.3155 12.6319 25.7805 11.4705 24.8295 10.6139C23.8784 9.75729 22.589 9.2754 21.2441 9.27393H20.2361C18.8912 9.2754 17.6018 9.75729 16.6507 10.6139C15.6997 11.4705 15.1647 12.6319 15.1631 13.8433V14.9216C15.1647 16.133 15.6998 17.2943 16.6508 18.1508C17.6018 19.0073 18.8912 19.489 20.2361 19.4903H21.2441C21.7699 19.4909 22.2741 19.6793 22.6459 20.0142C23.0178 20.3491 23.227 20.8032 23.2276 21.2769V22.3392C23.227 22.8129 23.0178 23.267 22.6459 23.6019C22.2741 23.9368 21.7699 24.1253 21.2441 24.1258H20.2361C19.7103 24.1253 19.2061 23.9368 18.8343 23.6019C18.4624 23.267 18.2532 22.8129 18.2526 22.3392V22.015C18.2526 21.646 18.0899 21.2921 17.8002 21.0312C17.5105 20.7702 17.1176 20.6236 16.7079 20.6236Z'
                fill='#42446E'
              />
              <path
                d='M2.87974 28.3258C3.65491 28.7224 4.53202 28.929 5.42352 28.9249C6.31503 28.9209 7.18976 28.7063 7.96044 28.3026C8.73111 27.8989 9.37077 27.3203 9.8156 26.6243C10.2604 25.9284 10.4948 25.1396 10.4955 24.3366V15.3391C10.4955 14.9701 10.3327 14.6161 10.043 14.3552C9.75332 14.0943 9.3604 13.9477 8.9507 13.9477C8.541 13.9477 8.14808 14.0943 7.85838 14.3552C7.56868 14.6161 7.40593 14.9701 7.40593 15.3391V24.3366C7.40518 24.6525 7.3126 24.9627 7.13739 25.2364C6.96219 25.51 6.71047 25.7376 6.40729 25.8964C6.10411 26.0552 5.76005 26.1397 5.40933 26.1416C5.05862 26.1434 4.71349 26.0625 4.4083 25.9068C4.16847 25.7836 3.96876 25.6059 3.82915 25.3914C3.68953 25.1769 3.61491 24.9331 3.61274 24.6845L3.52005 11.3819C3.51889 11.1333 3.59019 10.8887 3.7268 10.6726C3.86342 10.4565 4.06059 10.2765 4.29862 10.1505L17.043 3.42724C17.2814 3.30175 17.5522 3.23487 17.8283 3.23328C18.1044 3.23169 18.3762 3.29546 18.6163 3.41819L31.4519 9.99746C31.6917 10.1206 31.8914 10.2984 32.031 10.5129C32.1706 10.7274 32.2452 10.9712 32.2474 11.2198L32.3401 24.5224C32.3413 24.771 32.27 25.0156 32.1333 25.2317C31.9967 25.4478 31.7996 25.6278 31.5615 25.7538L18.8172 32.477C18.5788 32.6025 18.3079 32.6694 18.0318 32.671C17.7557 32.6726 17.484 32.6088 17.2438 32.4861L15.3576 31.5184C15.1813 31.4263 14.9864 31.3665 14.7842 31.3426C14.5821 31.3186 14.3767 31.331 14.1799 31.3789C13.983 31.4268 13.7987 31.5093 13.6375 31.6217C13.4762 31.7341 13.3413 31.8741 13.2404 32.0337C13.1395 32.1933 13.0747 32.3693 13.0497 32.5515C13.0247 32.7338 13.04 32.9187 13.0948 33.0956C13.1495 33.2725 13.2426 33.4379 13.3686 33.5822C13.4946 33.7266 13.6511 33.847 13.8291 33.9366L15.716 34.9036C16.4278 35.2673 17.233 35.4563 18.0513 35.4518C18.8696 35.4472 19.6722 35.2494 20.3789 34.8779L33.1233 28.1546C33.8286 27.781 34.4128 27.2473 34.8175 26.6068C35.2222 25.9662 35.4333 25.2413 35.4296 24.5043L35.3362 11.2038C35.3296 10.4669 35.1086 9.74438 34.6951 9.10847C34.2815 8.47256 33.69 7.94549 32.9796 7.57989L20.1433 0.999929C19.4316 0.636367 18.6263 0.447405 17.8081 0.451922C16.9898 0.456439 16.1872 0.654277 15.4805 1.02567L2.73608 7.74895C2.03077 8.12255 1.4466 8.65627 1.0419 9.29681C0.637192 9.93735 0.426114 10.6623 0.429733 11.3993L0.523193 24.7005C0.529462 25.4376 0.750401 26.1604 1.16393 26.7966C1.57746 27.4328 2.1691 27.9601 2.87974 28.3258Z'
                fill='#42446E'
              />
            </svg>

            {/* old logo */}
            {/* 
              <svg
              className='group h-7 w-7 transform transition-transform duration-300 ease-in-out hover:scale-110'
              width='35'
              height='35'
              viewBox='0 0 30 30'
              fill='none'
              xmlns='http://www.w3.org/2000/svg'
            >
              <g>
                <path
                  d='M29.9998 24.4233C29.9998 25.1469 29.4502 25.7312 28.7738 25.7312L16.5182 29.6527C15.8418 29.6527 15.2939 29.0685 15.2939 28.3449V15.2743C15.2939 14.5508 15.8418 13.9665 16.5182 13.9665L28.7738 10.0449C29.4502 10.0449 29.9998 10.6293 29.9998 11.3527V24.4233Z'
                  fill='#42446E'
                  className='transition-colors duration-300 ease-in-out'
                >
                  <animate attributeName='fill' values='#42446E; #ec4899' dur='4s' repeatCount='indefinite' /> 
                </path>
                <path
                  d='M13.4169 28.3449C13.4169 29.0685 12.8967 29.6527 12.2496 29.6527L1.75149 25.7312C1.10811 25.7312 0.587891 25.1469 0.587891 24.4233V11.3527C0.587891 10.6293 1.10811 10.0449 1.75149 10.0449L12.2496 13.9665C12.8967 13.9665 13.4169 14.5508 13.4169 15.2743V28.3449Z'
                  fill='#42446E'
                >
                  <animate attributeName='fill' values='#42446E; #ec4899' dur='3s' repeatCount='indefinite' /> 
                </path>
                <path
                  d='M30.0005 6.18386C30.0005 6.80741 28.7762 7.23874 28.7762 7.23874L16.5189 11.5309C16.5189 11.5309 15.4821 11.9623 14.6696 11.9623C13.859 11.9623 12.8737 11.5074 12.8737 11.5074L1.85162 7.29167C1.85162 7.29167 0.586914 6.87014 0.586914 6.18582C0.586914 5.50151 1.85162 5.0368 1.85162 5.0368L12.8774 0.821114C12.8774 0.821114 14.0189 0.366211 14.7046 0.366211C15.3884 0.366211 16.5244 0.801508 16.5244 0.801508L28.7707 5.0917C28.7726 5.08778 30.0005 5.55837 30.0005 6.18386Z'
                  fill='#42446E'
                >
                  <animate attributeName='fill' values='#42446E; #ec4899' dur='5s' repeatCount='indefinite' /> 
                </path>
              </g>
            </svg>
            */}
          </Link>
          <ul
            className={`navbar z-50 ${isDrawerOpen ? 'max-[1023px]:translate-x-[0]' : 'max-[1023px]:translate-x-[-100%]'}`}
            id='drawer-navigation'
            ref={ref}
          >
            <li className='flex items-center justify-between lg:hidden'>
              <Link
                href='/'
                className={`mb-3 pr-4 text-3xl font-semibold tracking-wider text-theme-secondary sm:text-4xl md:pr-0 dark:text-white`}
                onClick={onCloseDrawerNav}
              >
                <svg
                  className='group h-10 w-10 transform transition-transform duration-300 ease-in-out'
                  viewBox='0 0 36 36'
                  fill='none'
                  xmlns='http://www.w3.org/2000/svg'
                >
                  <path
                    d='M16.7079 20.6236C16.2982 20.6236 15.9052 20.7702 15.6155 21.0312C15.3258 21.2921 15.1631 21.646 15.1631 22.015V22.3392C15.1647 23.5507 15.6997 24.712 16.6507 25.5687C17.6018 26.4253 18.8912 26.9071 20.2361 26.9086H21.2441C22.589 26.9071 23.8784 26.4253 24.8295 25.5687C25.7805 24.712 26.3155 23.5507 26.3171 22.3392V21.2769C26.3155 20.0655 25.7805 18.9041 24.8295 18.0475C23.8784 17.1909 22.589 16.709 21.2441 16.7075H20.2361C19.7104 16.707 19.2064 16.5187 18.8345 16.1839C18.4627 15.8491 18.2534 15.3952 18.2526 14.9216V13.8433C18.2532 13.3696 18.4624 12.9155 18.8343 12.5806C19.2061 12.2457 19.7103 12.0573 20.2361 12.0567H21.2441C21.7699 12.0573 22.2741 12.2457 22.6459 12.5806C23.0178 12.9155 23.227 13.3696 23.2276 13.8433C23.2276 14.2123 23.3903 14.5662 23.68 14.8272C23.9697 15.0881 24.3626 15.2347 24.7723 15.2347C25.182 15.2347 25.575 15.0881 25.8647 14.8272C26.1544 14.5662 26.3171 14.2123 26.3171 13.8433C26.3155 12.6319 25.7805 11.4705 24.8295 10.6139C23.8784 9.75729 22.589 9.2754 21.2441 9.27393H20.2361C18.8912 9.2754 17.6018 9.75729 16.6507 10.6139C15.6997 11.4705 15.1647 12.6319 15.1631 13.8433V14.9216C15.1647 16.133 15.6998 17.2943 16.6508 18.1508C17.6018 19.0073 18.8912 19.489 20.2361 19.4903H21.2441C21.7699 19.4909 22.2741 19.6793 22.6459 20.0142C23.0178 20.3491 23.227 20.8032 23.2276 21.2769V22.3392C23.227 22.8129 23.0178 23.267 22.6459 23.6019C22.2741 23.9368 21.7699 24.1253 21.2441 24.1258H20.2361C19.7103 24.1253 19.2061 23.9368 18.8343 23.6019C18.4624 23.267 18.2532 22.8129 18.2526 22.3392V22.015C18.2526 21.646 18.0899 21.2921 17.8002 21.0312C17.5105 20.7702 17.1176 20.6236 16.7079 20.6236Z'
                    fill='#42446E'
                  />
                  <path
                    d='M2.87974 28.3258C3.65491 28.7224 4.53202 28.929 5.42352 28.9249C6.31503 28.9209 7.18976 28.7063 7.96044 28.3026C8.73111 27.8989 9.37077 27.3203 9.8156 26.6243C10.2604 25.9284 10.4948 25.1396 10.4955 24.3366V15.3391C10.4955 14.9701 10.3327 14.6161 10.043 14.3552C9.75332 14.0943 9.3604 13.9477 8.9507 13.9477C8.541 13.9477 8.14808 14.0943 7.85838 14.3552C7.56868 14.6161 7.40593 14.9701 7.40593 15.3391V24.3366C7.40518 24.6525 7.3126 24.9627 7.13739 25.2364C6.96219 25.51 6.71047 25.7376 6.40729 25.8964C6.10411 26.0552 5.76005 26.1397 5.40933 26.1416C5.05862 26.1434 4.71349 26.0625 4.4083 25.9068C4.16847 25.7836 3.96876 25.6059 3.82915 25.3914C3.68953 25.1769 3.61491 24.9331 3.61274 24.6845L3.52005 11.3819C3.51889 11.1333 3.59019 10.8887 3.7268 10.6726C3.86342 10.4565 4.06059 10.2765 4.29862 10.1505L17.043 3.42724C17.2814 3.30175 17.5522 3.23487 17.8283 3.23328C18.1044 3.23169 18.3762 3.29546 18.6163 3.41819L31.4519 9.99746C31.6917 10.1206 31.8914 10.2984 32.031 10.5129C32.1706 10.7274 32.2452 10.9712 32.2474 11.2198L32.3401 24.5224C32.3413 24.771 32.27 25.0156 32.1333 25.2317C31.9967 25.4478 31.7996 25.6278 31.5615 25.7538L18.8172 32.477C18.5788 32.6025 18.3079 32.6694 18.0318 32.671C17.7557 32.6726 17.484 32.6088 17.2438 32.4861L15.3576 31.5184C15.1813 31.4263 14.9864 31.3665 14.7842 31.3426C14.5821 31.3186 14.3767 31.331 14.1799 31.3789C13.983 31.4268 13.7987 31.5093 13.6375 31.6217C13.4762 31.7341 13.3413 31.8741 13.2404 32.0337C13.1395 32.1933 13.0747 32.3693 13.0497 32.5515C13.0247 32.7338 13.04 32.9187 13.0948 33.0956C13.1495 33.2725 13.2426 33.4379 13.3686 33.5822C13.4946 33.7266 13.6511 33.847 13.8291 33.9366L15.716 34.9036C16.4278 35.2673 17.233 35.4563 18.0513 35.4518C18.8696 35.4472 19.6722 35.2494 20.3789 34.8779L33.1233 28.1546C33.8286 27.781 34.4128 27.2473 34.8175 26.6068C35.2222 25.9662 35.4333 25.2413 35.4296 24.5043L35.3362 11.2038C35.3296 10.4669 35.1086 9.74438 34.6951 9.10847C34.2815 8.47256 33.69 7.94549 32.9796 7.57989L20.1433 0.999929C19.4316 0.636367 18.6263 0.447405 17.8081 0.451922C16.9898 0.456439 16.1872 0.654277 15.4805 1.02567L2.73608 7.74895C2.03077 8.12255 1.4466 8.65627 1.0419 9.29681C0.637192 9.93735 0.426114 10.6623 0.429733 11.3993L0.523193 24.7005C0.529462 25.4376 0.750401 26.1604 1.16393 26.7966C1.57746 27.4328 2.1691 27.9601 2.87974 28.3258Z'
                    fill='#42446E'
                  />
                </svg>
              </Link>
              <div className='absolute right-3 top-9 block lg:hidden'>
                <button
                  onClick={openDrawerNav}
                  className={`relative mt-2 flex h-[18px] w-[26px] cursor-pointer flex-col justify-between duration-300 ease-in`}
                >
                  <span
                    className={`delay-400 absolute top-0 inline h-[2px] w-full bg-theme-primary duration-300 ease-in dark:bg-white dark:opacity-70 ${isDrawerOpen ? 'rotate-[45deg]' : 'rotate-[0deg]'}`}
                  ></span>
                  <span
                    className={`delay-400 inline h-[2px] w-full bg-theme-primary duration-300 ease-in dark:bg-white dark:opacity-70 ${isDrawerOpen ? 'rotate-[-45deg]' : 'rotate-[0deg]'}`}
                  ></span>
                </button>
              </div>
            </li>
            <li>
              <Link
                href='/tree'
                className={`nav-list-item-link dark:hover:bg-initial text-center dark:hover:text-theme-dark-primary ${pathname === '/tree' ? 'after:w-full' : ''}`}
                onClick={onCloseDrawerNav}
              >
                Tree
              </Link>
            </li>
            <li className='lg:lg:mx-2'>
              <Link
                href='/n-queens'
                className={`nav-list-item-link ${pathname === '/n-queens' ? 'after:w-full' : ''}`}
                onClick={onCloseDrawerNav}
              >
                N-Queens
              </Link>
            </li>
            <li className='lg:mx-2'>
              <Link
                href='/sorting'
                className={`nav-list-item-link ${pathname === '/sorting' ? 'after:w-full' : ''}`}
                onClick={onCloseDrawerNav}
              >
                Sorting
              </Link>
            </li>

            <li className='lg:mx-2'>
              <Link
                href='/path-finding'
                className={`nav-list-item-link ${pathname === '/path-finding' ? 'after:w-full' : ''}`}
                onClick={onCloseDrawerNav}
              >
                Path finding
              </Link>
            </li>

            <li className='lg:mx-2'>
              <Link
                href='/searching'
                className={`nav-list-item-link ${pathname === '/searching' ? 'after:w-full' : ''}`}
                onClick={onCloseDrawerNav}
              >
                Searching
              </Link>
            </li>
            <li className='lg:mx-2'>
              <Link
                href='/linked-list'
                className={`nav-list-item-link ${pathname === '/linked-list' ? 'after:w-full' : ''}`}
                onClick={onCloseDrawerNav}
              >
                Linked list
              </Link>
            </li>

            <li className='mt-2 flex lg:mt-0 lg:ps-2'>
              <Link
                href='https://github.com/AlaminPu1007/algorithm-visualizer'
                target='_blank'
                className='group me-4 cursor-pointer sm:me-auto'
                data-testid='github-link-item'
                data-umami-event={`nav-github-repo`}
                onClick={onCloseDrawerNav}
              >
                <svg
                  width='24'
                  height='24'
                  viewBox='0 0 24 24'
                  fill='none'
                  xmlns='http://www.w3.org/2000/svg'
                  className='h-[100%] w-[100%] lg:h-[93%] lg:w-[93%]'
                >
                  <path
                    fillRule='evenodd'
                    clipRule='evenodd'
                    d='M12 0C5.37 0 0 5.50583 0 12.3035C0 17.7478 3.435 22.3463 8.205 23.9765C8.805 24.0842 9.03 23.715 9.03 23.3921C9.03 23.0999 9.015 22.131 9.015 21.1005C6 21.6696 5.22 20.347 4.98 19.6549C4.845 19.3012 4.26 18.2092 3.75 17.917C3.33 17.6863 2.73 17.1173 3.735 17.1019C4.68 17.0865 5.355 17.9939 5.58 18.363C6.66 20.2239 8.385 19.701 9.075 19.3781C9.18 18.5783 9.495 18.04 9.84 17.7325C7.17 17.4249 4.38 16.3637 4.38 11.6576C4.38 10.3196 4.845 9.21227 5.61 8.35102C5.49 8.04343 5.07 6.78232 5.73 5.09058C5.73 5.09058 6.735 4.76762 9.03 6.3517C9.99 6.07487 11.01 5.93645 12.03 5.93645C13.05 5.93645 14.07 6.07487 15.03 6.3517C17.325 4.75224 18.33 5.09058 18.33 5.09058C18.99 6.78232 18.57 8.04343 18.45 8.35102C19.215 9.21227 19.68 10.3042 19.68 11.6576C19.68 16.3791 16.875 17.4249 14.205 17.7325C14.64 18.1169 15.015 18.8552 15.015 20.0086C15.015 21.6542 15 22.9768 15 23.3921C15 23.715 15.225 24.0995 15.825 23.9765C18.2072 23.1519 20.2772 21.5821 21.7437 19.4881C23.2101 17.3942 23.9993 14.8814 24 12.3035C24 5.50583 18.63 0 12 0Z'
                    fill='#42446E'
                    className='duration-200 group-hover:fill-theme-btn dark:fill-theme-btn dark:group-hover:fill-white'
                  />
                </svg>
              </Link>
            </li>
          </ul>
        </div>

        {!isDrawerOpen ? (
          <div className='absolute right-[2%] top-[30px] flex duration-200 ease-in lg:hidden'>
            <button className='relative flex h-[18px] w-[26px] flex-col justify-between' onClick={openDrawerNav}>
              <span className='inline h-[2px] w-full bg-theme-primary dark:bg-white dark:opacity-70'></span>
              <span className='inline h-[2px] w-full bg-theme-primary dark:bg-white dark:opacity-70'></span>
              <span className='inline h-[2px] w-full bg-theme-primary dark:bg-white dark:opacity-70'></span>
            </button>
          </div>
        ) : null}
      </div>
    </nav>
  );
};

export default HeaderComponent;
